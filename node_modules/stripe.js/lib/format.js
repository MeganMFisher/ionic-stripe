'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.formatCardNumber = formatCardNumber;
exports.formatExpiry = formatExpiry;

var _cards = require('./cards');

function formatCardNumber(cardNumber) {
	var num = cardNumber.replace(/\D/g, '');
	var card = (0, _cards.cardFromNumber)(num);
	if (!card) {
		return num;
	}

	var upperLength = card.length[card.length.length - 1];
	num = num.slice(0, upperLength);
	if (card.format.global) {
		var res = num.match(card.format);
		return res ? res.join(' ') : null;
	} else {
		var groups = card.format.exec(num);
		if (!groups) {
			return null;
		}
		groups.shift();
		groups = groups.filter(function (n) {
			return n;
		}); // Filter empty groups
		return groups.join(' ');
	}
}

function formatExpiry(expiry) {
	var parts = expiry.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);
	if (!parts) {
		return '';
	}

	var mon = parts[1] || '';
	var sep = parts[2] || '';
	var year = parts[3] || '';

	if (year.length > 0) {
		sep = ' / ';
	} else if (sep === ' /') {
		mon = mon.substring(0, 1);
		sep = '';
	} else if (mon.length === 2 || sep.length > 0) {
		sep = ' / ';
	} else if (mon.length === 1 && mon !== '0' && mon !== '1') {
		mon = '0' + mon;
		sep = ' / ';
	}
	return mon + sep + year;
}